!function(e){var t={};function o(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(n,s,function(t){return e[t]}.bind(null,s));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/dist",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);const n=function(e,t){localStorage[e]=JSON.stringify(t)},s=function(e){return localStorage[e]?JSON.parse(localStorage[e]):[]},r=()=>{const e=document.createElement("div");return e.className="dropdown-lists__countryBlock",e},d=(e,t)=>{const o=document.createElement("div");return o.className="dropdown-lists__total-line",o.innerHTML=`\n  <div class="dropdown-lists__country">${e}</div>\n  <div class="dropdown-lists__count">${t}</div>\n`,o},l=e=>{const t=document.createElement("div");return t.dataset.cityLink=e.link,t.className="dropdown-lists__line",t.innerHTML=`\n  <div class="dropdown-lists__city">${e.name}</div>\n  <div class="dropdown-lists__count">${e.count}</div>\n`,t},c=(e,t)=>{e.cities.sort((e,t)=>t.count-e.count);const o=r(),n=d(e.country,e.count);o.append(n);for(let t=0;t<3;t++){const n=l(e.cities[t]);o.append(n)}t.append(o)},i=(e,t)=>{const o=document.querySelector(".dropdown-lists__list--autocomplete .dropdown-lists__col");o.innerHTML="";const n=e.reduce((e,o)=>e.concat(o.cities.filter(e=>e.name.toLowerCase().startsWith(t.toLowerCase()))),[]),s=r();if(n.forEach(e=>{const o=l(e),n=o.firstElementChild;console.log("child",n);const r=n.textContent;n.innerHTML=`<span class="match">${r.slice(0,t.length)}</span>${r.slice(t.length)}`,s.append(o)}),!n.length){const e=l({name:"Ничего не найдено",count:"",link:"none"});s.append(e)}o.append(s)},a=({elem:e,display:t,mode:o="show",className:n})=>{"hide"===o&&(e.style.visibility="hidden",e.style.display="none"),"add"===o&&e.classList.add(n),"remove"===o&&e.classList.remove(n),"toggle"===o&&e.classList.toggle(n),"show"===o&&(e.style.visibility="visible",e.style.display=t||"")},u=({dropdowns:e,flag:t,dropdown:o})=>{if(console.log(o),o)switch(t){case"on":o.style.display="block";break;case"off":o.style.display="none";break;default:e.forEach(e=>e.style.display=e===o?"block":"none")}else e.forEach(e=>e.style.display="none")},p=({timing:e=(e=>e),draw:t,duration:o=500})=>{const n=performance.now();requestAnimationFrame((function s(r){let d=(r-n)/o;d>1&&(d=1);const l=e(d);t(l),d<1&&requestAnimationFrame(s)}))},m=document.getElementById("select-cities"),f=document.querySelectorAll(".dropdown-lists__list"),y=e=>{const t=+m.dataset.dropdown,o=t?e:1-e;console.log(o),console.log(-e),f[0].style.transform=`translateX(${-415*o}px)`,f[1].style.transform=`translateX(${-415*o}px)`,1===e&&(u({dropdowns:f,flag:"off",dropdown:t?f[0]:f[1]}),f[0].style.transform="",f[1].style.transform="")},w=(e,t,o,n,s,c,m)=>{o.addEventListener("focus",()=>{u({dropdowns:s,dropdown:s[o.dataset.dropdown]||s[0]})}),document.addEventListener("click",e=>{e.target.closest("#select-cities, .dropdown-lists__list")||u({dropdowns:s}),e.target===c&&(o.value="",o.dataset.dropdown="0",a({elem:c,mode:"hide"}),a({elem:m,mode:"add",className:"button--disabled"}))}),n.addEventListener("click",n=>{const f=o.dataset.dropdown,w=n.target.closest(".dropdown-lists__total-line"),_=n.target.closest(".dropdown-lists__line");w&&(+f?(o.value="",o.dataset.dropdown="0",u({dropdowns:s,flag:"on",dropdown:s[0]}),s[0].style.transform="translateX(-415px)",s[1].style.transform="translateX(-415px)",p({draw:y})):(o.value=w.firstElementChild.textContent,o.dataset.dropdown="1",((e,t)=>{const o=document.querySelector(".dropdown-lists__list--select .dropdown-lists__col");o.innerHTML="";const n=e.find(e=>e.country===t);n.cities.sort((e,t)=>t.count-e.count);const s=r(),c=d(n.country,n.count);s.append(c);for(let e=0;e<n.cities.length;e++){const t=l(n.cities[e]);s.append(t)}o.append(s)})(e,o.value),u({dropdowns:s,flag:"on",dropdown:s[1]}),p({draw:y}))),_&&("none"!==_.dataset.cityLink&&(o.value=_.firstElementChild.textContent,o.dataset.dropdown="2",i(e,o.value),t.href=_.dataset.cityLink,a({elem:m,mode:"remove",className:"button--disabled"})),u({dropdowns:s})),a({elem:c,display:"block"})}),o.addEventListener("input",()=>{o.value?(i(e,o.value),u({dropdowns:s,dropdown:s[2]})):(u({dropdowns:s,dropdown:s[0]}),a({elem:c,mode:"hide"}),a({elem:m,mode:"add",className:"button--disabled"}))})};function _(e,t,o,n,s){let r=`${e}=${t}`;if(o){r+="; expires="+new Date(o,n-1,s).toGMTString()}document.cookie=r}const v=document.querySelector(".button"),g=document.getElementById("select-cities"),h=document.querySelector(".dropdown"),b=document.querySelectorAll(".dropdown-lists__list"),E=document.querySelector(".close-button"),S=document.querySelector(".button"),L=document.querySelector(".preloader");u({dropdowns:b}),a({elem:S,mode:"add",className:"button--disabled"});const k=(()=>{let e=(e=>{const t=document.cookie.split("; "),o={};return t.forEach(e=>{const t=e=e.split("=");o[t[0]]=t[1]}),o[e]})("locale");if(e)return e;for(;!e;){if(e=prompt("Пожалуйста выберете локаль: RU, EN или DE"),e&&e.match(/(RU)|(EN)|(DE)s/))return _("locale",e,2020,12,31),e;alert("Вы ввели невернгое значение локали."),e=""}})();var N,x;(N="db_cities.json",x=k,new Promise((e,t)=>{const o=s("citiesData"+x);o.length?e(o):setTimeout(()=>{const t=fetch(N,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>{if(200!==e.status)throw new Error("Network status not 200.");return e.json()}).then(e=>{const t=e[x];return n("citiesData"+x,t),t});e(t)},2e3)})).then(e=>{a({elem:L,mode:"hide"}),((e,t)=>{const o={RU:"Россия",EN:"United Kingdom",DE:"Deutschland"},n=document.querySelector(".dropdown-lists__list--default .dropdown-lists__col");n.innerHTML="",c(e.find(e=>e.country===o[t]),n),e.forEach(e=>{e.country!==o[t]&&c(e,n)})})(e,k),w(e,v,g,h,b,E,S)}).catch(e=>{v.insertAdjacentHTML("afterend",'\n      <div class="message">\n        <p>Нам очень жаль, но что-то пошло не так.</p>\n        <p>Пожалуйста, обновите страницу или повторите позже.</p>\n      </div>\n    '),console.error(e)})}]);